[
  {
    "objectID": "projects/StatisticalGenetics/StatisticalGeneticsCapstone.html",
    "href": "projects/StatisticalGenetics/StatisticalGeneticsCapstone.html",
    "title": "Population Inference Using a Hidden Markov Model Approach",
    "section": "",
    "text": "Using genetic data, it is possible to determine a person’s genetic origin. In other words, once a geneticist analyzes an individual’s DNA, it can be inferred what geographic location their ancestors are from. This discovery can provide new understanding to historical mixing of populations and the potential detection of diseases in certain populations. We were curious if this could be done in a simulation study using a Hidden Markov Model.\nCan a person’s genetic origin be determined from their DNA after several generations of movement and reproduction in a simulation study?\nBefore jumping in, there are some key definitions you need to understand first.\n\n\n\n\n\n\nAllele - different possible nucleotides at a location on the genome\nMinor Allele Frequency (MAF) - the frequency that the less common allele is present at that location\nSingle Nucleotide Polymorphism (SNP) - A position on the genome where the MAF is greater than 1%\nRecombination - parts of DNA being broken and reordered\nAdmixture - the mixing of populations resulting in a new population from multiple sources\nLinkage - genes close together on the genome are more likely to be passed down as a unit"
  },
  {
    "objectID": "projects/StatisticalGenetics/StatisticalGeneticsCapstone.html#movement",
    "href": "projects/StatisticalGenetics/StatisticalGeneticsCapstone.html#movement",
    "title": "Population Inference Using a Hidden Markov Model Approach",
    "section": "Movement",
    "text": "Movement\nNow that the individuals have identifying DNA to their region, we can start moving them around the grid.\nTo move between squares, it is assumed that an individual is most likely to move to an adjacent square, or one nearby. This is not identical to real life. If an individual moves in real life, they could move to a city or not to an adjacent town, but for purposes of our simulation study, we assume that nearby squares are the most likely places for individuals to move.\nThe below matrix shows the squares an individual starting near the center of the grid could land after one generation of movement.\n\n\n\n\n\nWith around a 65% chance, the most likely location for an individual to end up after one generation of movement is the same square. That probability isn’t necessarily translatable, though. If an individual is in a square near the edge, their probability of staying in the same square increases.\n\n\n\n\n\nWith an individual starting in a corner, they have an 81% chance of not moving.\nFor each individual, in each square, this process is run. So for the 10 individuals in the bottom left corner, each has an 81% chance of staying. However, there is only about a 12% chance (0.81^10) of all 10 staying. Once all 1,000 individuals are “moved” (either to a new square or their initial square), one stage of movement is complete. For this study, we simulate 10 stages This allows opportunities for individuals to move to a new region, or just generally move around. The below graph shows the count of individuals per square after 10 generations.\n\n\n\n\n\nAs you can see, there is one square in the middle with no one. This happened in this specific simulation (seed set at 494), but other simulations would obviously have different results. Because movement is random, and no one is forced to relocate anywhere specific, oddities like this can happen."
  },
  {
    "objectID": "projects/StatisticalGenetics/StatisticalGeneticsCapstone.html#reproduction",
    "href": "projects/StatisticalGenetics/StatisticalGeneticsCapstone.html#reproduction",
    "title": "Population Inference Using a Hidden Markov Model Approach",
    "section": "Reproduction",
    "text": "Reproduction\nHowever, only looking at movement isn’t enough. To answer our research question, we also need to simulate reproduction between each stage of movement.\nFor each square, two random individuals are sampled to create offspring. Remember, there are 1,000 SNPs for each individual. For each SNP, there is a 50% chance of Parent 1 contributing DNA and a 50% chance of Parent 2 contributing DNA. In real life, there would be a chance of mutation, though we ignored that possibility for two reasons. First, mutations are extraordinarily rare in real life, so to accurately capture the chance of a mutation, they would almost never happen in this study. Second, it was easier to simulate the data without mutations.\nThe process of reproduction is repeated for as many times as their are individuals in the square. So when there are 10 individuals in a square pre-reproduction, there will be 10 individual in that square post-reproduction. But, as explained above, movement is random. In this study, there was one generation with a square containing only 1 individual. Because they did not have a partner, they did not reproduce and “died off”, meaning that after 10 generations, the study was left with 999 individuals.\nIt is also important to note that because reproduction occurs between any two random individuals in the square, there is a possibility of multiple individuals not reproducing whatsoever. This also means that there are no “nuclear families.” An individual could reproduce numerous times, each with a different partner. There is also no gender designation in this simulation.\nThroughout each generation, a “true” proportion of DNA from Region 1 and Region 2 is recorded. So if an individual from Region 1 and an individual from Region 2 reproduce, the child will be 50% Region 1 and 50% Region 2. Then if that child reproduces with someone 100% from Region 1, the newest child will be 75% Region 1 and 25% Region 2, and so on. This is tracked to measure against the Hidden Markov Model results later on. But following the true proportion allows us to visualize what the average origin of each square is.\n\n\n\n\n\nThe squares furthest away from the region border remain fairly homogeneous throughout all 10 generations, while squares near the border become heterogeneous.\nThe Minor Allele Frequency of each SNP will also change by region.\n\n\n\n\n\nThe MAF of the last 500 SNPs remains indistinguishable by region, regardless of the generation. However, as expected, the first 500 SNPs still show a distinction by region, though that distinction becomes more jumbled through each generation, as the regions are no longer isolated from each other."
  },
  {
    "objectID": "projects/StatisticalGenetics/StatisticalGeneticsCapstone.html#example",
    "href": "projects/StatisticalGenetics/StatisticalGeneticsCapstone.html#example",
    "title": "Population Inference Using a Hidden Markov Model Approach",
    "section": "Example",
    "text": "Example\nTo give us a little intuition about HMMs, let’s look at an example with weather. Let’s say we have a friend, John, in Wisconsin whose outfits only depend on the weather. We’ll make the assumption that the weather on one day is dependent on the weather from the previous day. In Wisconsin it can be sunny, cloudy, or rainy. When it’s sunny, the following day has a 60% chance of being sunny again, a 30% chance of being cloudy, and a 10% chance of being rainy. If it happens to be cloudy, the following day has a 50% chance of being cloudy, a 30% chance of being rainy and a 20% chance of being sunny. Finally the probabilities for when it’s rainy are as follows, 40% chance of being rainy the next day, 30% chance of being cloudy and 30% chance of being sunny. We can visualize these probabilities like this:\n\n\n\nA visualization of weather probabilities dependent on the previous day’s weather.\n\n\nThe probabilities above are the transition probabilities. Now since we aren’t in Wisconsin, we can’t actually observe the weather, but John has a fashion blog where he posts pictures of his outfits so we are able to observe these. From these observations we know that when it’s sunny out John has a 70% chance of wearing yellow, a 20% chance of wearing blue and a 10% chance of wearing grey. Now when the weather is cloudy, John has a 50% chance of wearing grey, a 30% chance of wearing blue and a 20% chance of wearing yellow. Lastly, when the weather is rainy, John has a 80% chance of wearing blue, a 10% chance of wearing yellow and a 10% chance of wearing grey. These probabilities are the emission probabilities. Combining the emission probabilities with the transition probabilities we’re left with the visualization below.\n\n\n\nThe same visualization of weather probabilities with corresponding clothes probabilities dependent on weather.\n\n\nThe visualization above outlines the framework for a hidden markov model. Over a sequence of days, we make observations of John’s outfits and from this sequence we can determine the pattern the weather most likely took over that sequence. For example if, over three days, we observe the sequence of yellow shirt, yellow shirt, grey shirt, the most likely sequence of weather, based on the transition and emission probabilities, would be sunny, sunny, cloudy."
  },
  {
    "objectID": "projects/StatisticalGenetics/StatisticalGeneticsCapstone.html#in-a-genetic-context",
    "href": "projects/StatisticalGenetics/StatisticalGeneticsCapstone.html#in-a-genetic-context",
    "title": "Population Inference Using a Hidden Markov Model Approach",
    "section": "In a Genetic Context",
    "text": "In a Genetic Context\nNow that we understand a little more about HMMs, let’s translate that knowledge to a genetic context. In this case our hidden sequence consists of the origin of the person’s genome and the observed variables are the person’s genotypes. Using genome sequencing we’re able to determine the individual SNPs within a person’s DNA, but just because we know what the particular SNP is doesn’t mean we know the ancestral origin of that section of the DNA sequence. Using the STRUCTURE software, that is based on HMMs, we can attempt to determine the region of origin of the individuals. The equations below are the framework for the software:\n\n\n\nEquations for the Hidden Markov Model\n\n\nThe first equation explains the probability for the origin of the first loci. After the origin of the first loci is determined, the software switches to the second equation where the hidden markov model becomes more obvious. The second equation has to do with moving from loci to loci and from one loci to the next. STRUCTURE has two options, the first being that the origin stays the same, summarized by the top equation. There are 2 ways to stay within the same origin, the first being no recombination occurring between loci. If we move from the first loci to the second and no recombination has occurred, there’s no way for the origin to differ. Now there’s also the chance that recombination has occurred, but it’s still possible that the recombination is still from the previous origin, summarized by the second term in the equation. The term exp(−dl​r) represents the probability of no recombination occurring given the recombination rate (a poisson process) and the distance between loci. It follows that 1-exp(−dl​r) would be the probability of recombination occurring, but k’ = k which explains the population of origin staying the same from one loci to the next. The second equation again calculates the probability of recombination occurring, with the expression 1-exp(−dl​r), but here we change the population of origin for this chunk of the DNA as k’ is not equal to k.\nNow that we have a bit of a better idea of the equations STRUCTURE uses to sift through the genome we can start to understand how the model runs. The STRUCTURE software can be found here, and is free to download. Now the first necessary item to run structure is genetic data. There are a few issues I’ve run into regarding the data formatting, the first being that you need column titles for the chosen SNPs. Individual and population markers are also necessary, however the population markers don’t seem to have too many constraints. The table below shows the ancestral percentages for individuals when a population marker was given for two distinct populations and then again when the marker was set to 0. As is evident in the table, the inferred clusters are almost exactly the same across the two tables despite the given population being different.\n\nWhen running, STRUCTURE reads the mainparams document within the same folder as the program, so this document is where you would set all the parameters that structure relies on. The only assumption that is required for STRUCTURE is the number of populations the data comes from, so this will differ depending on the data, but an accurate assumption is crucial for STRUCTURE to run accurately. The rest of the mainparams file contains a number of other parameters including the number of individuals in the data, number of loci, along with others. Accurate parameter definitions are crucial for the program to run correctly."
  },
  {
    "objectID": "projects/StatisticalGenetics/StatisticalGeneticsCapstone.html#limitations",
    "href": "projects/StatisticalGenetics/StatisticalGeneticsCapstone.html#limitations",
    "title": "Population Inference Using a Hidden Markov Model Approach",
    "section": "Limitations",
    "text": "Limitations\nA few limitations that could be addressed in further work on this project include: more accurate representation of genetic data, non-random population movement, and more realistic passing down of genes. The genetic data we simulated only included 1000 SNPs and the full human genome contains around 3 billion base pairs, so the overall size of the data wasn’t the most realistic. SNPs are also more random than we determined them to be, so rather than the first 500 SNPs being different between the two populations and the next 500 being shared between the two, a better interspersing of SNPs would better replicate reality. STRUCTURE also uses the assumption that genes are passed down in “chunks” - replicating the idea of linkage - and our simulations did not take that into account. With that in mind the passing down of genes was not representative of reality. The movement included in this simulation was also completely random, where in reality there are motivations behind why/when/where people move, that our study did not capture."
  },
  {
    "objectID": "projects/DataScience/DataScienceCapstone.html",
    "href": "projects/DataScience/DataScienceCapstone.html",
    "title": "Food Accessibility in Minneapolis: A Study of Public Transit",
    "section": "",
    "text": "In urban areas across the country, issues of food insecurity and public transportation are critical to the health and well-being of communities. This is certainly the case in Minnesota, where according to Hunger Solutions, 1 in 9 people, or nearly 500,000 Minnesotans, are food insecure. While food insecurity and public transit access are both issues that public policymakers and social scientists are concerned with, we wanted to investigate the intersection between the two with the research question: Where should a food shelf be placed in Minneapolis to support the most people in the most need? In other words, we were interested in the relationship between transit and food accessibility in Minneapolis. It seemed intuitive that a lack of access to reliable, fast public transit would exacerbate the effects of urban food deserts, making it far harder for disadvantaged or low income people to get to food sources. However, we wanted to better understand the nature of this relationship both geographically and quantitatively.\nAdditional resources on food insecurity and public transit in Minnesota and the Twin Cities:  1. University of Minnesota Food Security Dashboard: https://hfhl.umn.edu/resources/dashboardintro  2. Minnesota Department of Health: https://www.health.state.mn.us/docs/communities/titlev/foodaccess.pdf  3. Twin Cities Public Transit Background: https://doitgreen.org/topics/transportation/history-transit-twin-cities/"
  },
  {
    "objectID": "projects/DataScience/DataScienceCapstone.html#appendix",
    "href": "projects/DataScience/DataScienceCapstone.html#appendix",
    "title": "Food Accessibility in Minneapolis: A Study of Public Transit",
    "section": "Appendix",
    "text": "Appendix\nAppendix 1 - House Number Bar Plot\nNumeric distribution of Minneapolis house number ending digits.\n\n\n\n\n\nAppendix 2 - Twin Cities Metro Transit Routes"
  }
]